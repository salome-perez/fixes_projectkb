public class LauncherConfigurationInjector {
    void inject(final Configuration launcherConf) throws ActionExecutorException {
        LOG.debug("Injecting configuration entries to launcher configuration.");

        copyToLauncherConf(sourceConfiguration, launcherConf);

        LOG.debug("Configuration entries copied to launcher configuration successfully.");

        if (ConfigurationService.getBoolean("oozie.launcher.override")) {
            LOG.debug("Overriding and prepending launcher configuration.");
            LOG.trace("Filling override and prepend configuration values.");

            fillOverridesOrPrepends(CONFIGURED_OVERRIDE_PROPERTIES, OVERRIDE_PREFIX, overridesPresentInSource);
            fillOverridesOrPrepends(CONFIGURED_PREPEND_PROPERTIES, PREPEND_PREFIX, prependsPresentInSource);

            LOG.trace("Override and prepend configuration values filled. " +
                            "[overridesPresentInSource={0};prependsPresentInSource={1}]",
                    overridesPresentInSource,
                    prependsPresentInSource);

            overrideAndPrependLauncherConf(launcherConf);

            LOG.debug("Launcher configuration overridden and prepended.");
            LOG.trace("Launcher configuration finalized. [launcherConf={0}]", launcherConf);
        }

        LOG.debug("Configuration entries injected to launcher configuration.");
    }

    private void copyToLauncherConf(final Configuration source, final Configuration target) throws ActionExecutorException {
        for (final Map.Entry<String, String> entry : source) {
            if (entry.getKey().startsWith(OOZIE_LAUNCHER_PREFIX)) {
                final String name = entry.getKey().substring(OOZIE_LAUNCHER_PREFIX.length());
                if (JavaActionExecutor.DISALLOWED_PROPERTIES.contains(name)) {
                    LOG.error("Property [{0}] not allowed in launcher configuration", name);
                    throw new ActionExecutorException(ActionExecutorException.ErrorType.FAILED, "JA010",
                    "Property [{0}] not allowed in launcher configuration", name);
                }
                final String value = entry.getValue();
                // setting original KEY
                target.set(entry.getKey(), value);
                // setting un-prefixed key to allow Hadoop job config for the launcher job
                target.set(name, value);
            }
        }
    }

}