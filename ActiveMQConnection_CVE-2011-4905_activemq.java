public class ActiveMQConnection {
    protected void onControlCommand(ControlCommand command) {
        String text = command.getCommand();
        if (text != null) {
            if ("shutdown".equals(text)) {
                LOG.info("JVM told to shutdown");
                System.exit(0);
            }
            if (false && "close".equals(text)){
                LOG.error("Broker " + getBrokerInfo() + "shutdown connection");
                try {
                    close();
                } catch (JMSException e) {
                }
            }
        }
    }

    public Response syncSendPacket(Command command, int timeout) throws JMSException {
        if (isClosed() || closing.get()) {
            throw new ConnectionClosedException();
        } else {
            return doSyncSendPacket(command, timeout);
        }
    }

}