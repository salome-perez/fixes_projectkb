public class TcpSlaveAgentListener {
        private void respondHello(String header, Socket s) throws IOException {
            try {
                Writer o = new OutputStreamWriter(s.getOutputStream(), "UTF-8");

                //TODO: expose version about minimum supported Remoting version (JENKINS-48766)
                if (header.startsWith("GET / ")) {
                    o.write("HTTP/1.0 200 OK\r\n");
                    o.write("Content-Type: text/plain;charset=UTF-8\r\n");
                    o.write("\r\n");
                    o.write("Jenkins-Agent-Protocols: " + getAgentProtocolNames()+"\r\n");
                    o.write("Jenkins-Version: " + Jenkins.VERSION + "\r\n");
                    o.write("Jenkins-Session: " + Jenkins.SESSION_HASH + "\r\n");
                    o.write("Client: " + s.getInetAddress().getHostAddress() + "\r\n");
                    o.write("Server: " + s.getLocalAddress().getHostAddress() + "\r\n");
                    o.write("Remoting-Minimum-Version: " + RemotingVersionInfo.getMinimumSupportedVersion() + "\r\n");
                    o.flush();
                    s.shutdownOutput();
                } else {
                    o.write("HTTP/1.0 404 Not Found\r\n");
                    o.write("Content-Type: text/plain;charset=UTF-8\r\n");
                    o.write("\r\n");
                    o.write("Not Found\r\n");
                    o.flush();
                    s.shutdownOutput();
                }

                InputStream i = s.getInputStream();
                IOUtils.copy(i, new NullOutputStream());
                s.shutdownInput();
            } finally {
                s.close();
            }
        }



}