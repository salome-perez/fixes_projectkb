public class IgniteDhtPartitionHistorySuppliersMap {
    @Nullable public synchronized UUID getSupplier(int grpId, int partId, long cntrSince) {
        if (map == null)
            return null;

        for (Map.Entry<UUID, Map<T2<Integer, Integer>, Long>> e : map.entrySet()) {
            UUID supplierNode = e.getKey();

            Long historyCounter = e.getValue().get(new T2<>(grpId, partId));

            if (historyCounter != null && historyCounter <= cntrSince)
                return supplierNode;
        }

        return null;
    }

}