public class ReportExportExecution {
    public void export() {
        if (input.parameterNumber() >= 2) {
            final String[] parameters = Arrays.copyOf(input.getParameters(), input.parameterNumber() - 1);
            for (final String parameter : parameters) {
                try {
                    String result = reportSyncopeOperations.exportExecutionResult(parameter, input.lastParameter());
                    reportResultManager.genericMessage(result + "created.");
                } catch (final WebServiceException | SyncopeClientException e) {
                    LOG.error("Error exporting execution", e);
                    if (e.getMessage().startsWith("NotFound")) {
                        reportResultManager.notFoundError("Report", parameter);
                    } else {
                        reportResultManager.genericError(e.getMessage());
                    }
                } catch (final Exception e) {
                    LOG.error("Error exporting execution", e);
                    reportResultManager.genericError(
                            " - Error creating " + "export_" + parameter + " " + e.getMessage());
                }
                break;
            }
        } else {
            reportResultManager.commandOptionError(EXPORT_EXECUTION_HELP_MESSAGE);
        }
    }

}