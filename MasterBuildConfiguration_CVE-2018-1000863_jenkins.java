public class MasterBuildConfiguration {
    @Override
    public boolean configure(StaplerRequest req, JSONObject json) throws FormException {
        Jenkins j = Jenkins.getInstance();
        try {
            // for compatibility reasons, this value is stored in Jenkins
            String num = json.getString("numExecutors");
            if (!num.matches("\\d+")) {
                throw new FormException(Messages.Hudson_Computer_IncorrectNumberOfExecutors(),"numExecutors");
            }
            
            j.setNumExecutors(json.getInt("numExecutors"));
            if (req.hasParameter("master.mode"))
                j.setMode(Mode.valueOf(req.getParameter("master.mode")));
            else
                j.setMode(Mode.NORMAL);

            j.setLabelString(json.optString("labelString", ""));

            return true;
        } catch (IOException e) {
            throw new FormException(e,"numExecutors");
        }
    }

}