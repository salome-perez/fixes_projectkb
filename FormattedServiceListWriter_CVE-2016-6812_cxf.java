public class FormattedServiceListWriter {
    private String getAbsoluteAddress(String basePath, AbstractDestination d) {
        String endpointAddress = (String)d.getEndpointInfo().getProperty("publishedEndpointUrl");
        if (endpointAddress != null) {
            return endpointAddress;
        }
        endpointAddress = d.getEndpointInfo().getAddress();
        if (endpointAddress.startsWith("http://") || endpointAddress.startsWith("https://")) {
            if (endpointAddress.startsWith(basePath) || showForeignContexts) {
                return endpointAddress;
            } else {
                return null;
            }
        } else {
            String address = basePath;
            if (address.endsWith("/") && endpointAddress.startsWith("/")) { 
                address = address.substring(0, address.length() - 1);
            }
            return address + endpointAddress;
        }
    }

}