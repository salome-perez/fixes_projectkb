public class TableBuilder {
  public TableBuilder addTableParam(String key, String value) {
    if (tableParams == null) {
      tableParams = new HashMap<>();
    }
    tableParams.put(key, value);
    return this;
  }

  public Table build() throws MetaException {
    if (dbName == null || tableName == null) {
      throw new MetaException("You must set the database and table name");
    }
    if (owner == null) {
      try {
        owner = SecurityUtils.getUser();
      } catch (IOException e) {
        throw MetaStoreUtils.newMetaException(e);
      }
    }
    Table t = new Table(tableName, dbName, owner, createTime, lastAccessTime, retention, buildSd(),
        partCols, tableParams, viewOriginalText, viewExpandedText, type);
    if (rewriteEnabled) {
      t.setRewriteEnabled(true);
    }
    if (temporary) {
      t.setTemporary(temporary);
    }
    return t;
  }

}