public class ConnInstanceValidator {
    public boolean isValid(final ConnInstance connInstance, final ConstraintValidatorContext context) {
        context.disableDefaultConstraintViolation();

        boolean isValid = true;

        if (isHtml(connInstance.getDisplayName())) {
            context.buildConstraintViolationWithTemplate(
                    getTemplate(EntityViolationType.InvalidName, "Invalid display name")).
                    addPropertyNode("displayName").addConstraintViolation();

            isValid = false;
        }

        try {
            URIUtils.buildForConnId(connInstance.getLocation());
        } catch (Exception e) {
            LOG.error("While validating {}", connInstance.getLocation(), e);

            context.disableDefaultConstraintViolation();
            context.buildConstraintViolationWithTemplate(
                    getTemplate(EntityViolationType.InvalidConnInstanceLocation, e.getMessage())).
                    addPropertyNode("location").addConstraintViolation();

            isValid = false;
        }

        if (isValid && connInstance.getPoolConf() != null) {
            try {
                ConnPoolConfUtils.getObjectPoolConfiguration(connInstance.getPoolConf()).validate();
            } catch (Exception e) {
                LOG.error("Invalid pool configuration", e);

                context.disableDefaultConstraintViolation();
                context.buildConstraintViolationWithTemplate(
                        getTemplate(EntityViolationType.InvalidConnPoolConf, e.getMessage())).
                        addPropertyNode("poolConf").addConstraintViolation();

                isValid = false;
            }
        }

        return isValid;
    }

}