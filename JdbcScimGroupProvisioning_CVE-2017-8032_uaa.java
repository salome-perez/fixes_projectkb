public class JdbcScimGroupProvisioning {
    @Override
    public ScimGroup delete(String id, int version) throws ScimResourceNotFoundException {
        ScimGroup group = retrieve(id);
        membershipManager.removeMembersByGroupId(id);
        externalGroupMappingManager.unmapAll(id);
        int deleted;
        if (version > 0) {
            deleted = jdbcTemplate.update(DELETE_GROUP_SQL + " and version=?;", id, version);
        } else {
            deleted = jdbcTemplate.update(DELETE_GROUP_SQL, id);
        }
        if (deleted != 1) {
            throw new IncorrectResultSizeDataAccessException(1, deleted);
        }
        return group;
    }

}