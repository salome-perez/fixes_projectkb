public class ResetPasswordController {
    public String resetPasswordPage(Model model,
                                    HttpServletResponse response,
                                    @RequestParam("code") String code,
                                    @RequestParam("email") String email) {

        ExpiringCode expiringCode = codeStore.retrieveCode(code);
        if (expiringCode==null) {
            return handleUnprocessableEntity(model, response, "message_code", "bad_code");
        } else {
            Timestamp fiveMinutes = new Timestamp(System.currentTimeMillis()+(1000*60*5));
            model.addAttribute("code", codeStore.generateCode(expiringCode.getData(), fiveMinutes).getCode());
            model.addAttribute("email", email);
            return "reset_password";
        }
    }

}